<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Avoid the Zones</title>
<style>
  body {
    margin: 0; background: #111; display: flex; justify-content: center; align-items: center; height: 100vh;
    color: #0ff; font-family: monospace;
    user-select: none;
  }
  canvas {
    background: #222;
    border: 3px solid #0ff;
    border-radius: 8px;
    box-shadow: 0 0 20px #0ff;
  }
  #game-over {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: #f33;
    font-size: 48px;
    font-weight: bold;
    display: none;
  }
  #restart-btn {
    position: absolute;
    top: 60%;
    left: 50%;
    transform: translateX(-50%);
    padding: 10px 20px;
    font-size: 20px;
    background: #0ff;
    color: #111;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    display: none;
  }
</style>
</head>
<body>

<canvas id="gameCanvas" width="600" height="400"></canvas>
<div id="game-over">Game Over!</div>
<button id="restart-btn">Recommencer</button>

<script>
(() => {
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');

  const WIDTH = canvas.width;
  const HEIGHT = canvas.height;

  // Joueur
  const player = {
    x: WIDTH / 2 - 15,
    y: HEIGHT / 2 - 15,
    size: 30,
    speed: 5,
    dx: 0,
    dy: 0,
  };

  // Zone dangereuse
  const zone = {
    x: Math.random() * (WIDTH - 100),
    y: Math.random() * (HEIGHT - 100),
    width: 100,
    height: 100,
    timer: 0,
    changeInterval: 150, // frames avant de changer de position (~2.5s à 60fps)
  };

  let score = 0;
  let gameOver = false;

  // Gérer les touches pressées
  const keys = {};
  window.addEventListener('keydown', e => {
    keys[e.key] = true;
  });
  window.addEventListener('keyup', e => {
    keys[e.key] = false;
  });

  function movePlayer() {
    if (keys['ArrowUp'] && player.y > 0) player.y -= player.speed;
    if (keys['ArrowDown'] && player.y < HEIGHT - player.size) player.y += player.speed;
    if (keys['ArrowLeft'] && player.x > 0) player.x -= player.speed;
    if (keys['ArrowRight'] && player.x < WIDTH - player.size) player.x += player.speed;
  }

  function updateZone() {
    zone.timer++;
    if (zone.timer >= zone.changeInterval) {
      zone.timer = 0;
      zone.x = Math.random() * (WIDTH - zone.width);
      zone.y = Math.random() * (HEIGHT - zone.height);
    }
  }

  function checkCollision() {
    if (
      player.x < zone.x + zone.width &&
      player.x + player.size > zone.x &&
      player.y < zone.y + zone.height &&
      player.y + player.size > zone.y
    ) {
      gameOver = true;
      showGameOver();
    }
  }

  function showGameOver() {
    document.getElementById('game-over').style.display = 'block';
    document.getElementById('restart-btn').style.display = 'block';
  }

  function resetGame() {
    player.x = WIDTH / 2 - 15;
    player.y = HEIGHT / 2 - 15;
    score = 0;
    gameOver = false;
    zone.x = Math.random() * (WIDTH - zone.width);
    zone.y = Math.random() * (HEIGHT - zone.height);
    zone.timer = 0;
    document.getElementById('game-over').style.display = 'none';
    document.getElementById('restart-btn').style.display = 'none';
    loop();
  }

  function updateScore() {
    score++;
  }

  function draw() {
    ctx.clearRect(0, 0, WIDTH, HEIGHT);

    // Zone dangereuse (rouge)
    ctx.fillStyle = '#f33';
    ctx.shadowColor = '#f33';
    ctx.shadowBlur = 15;
    ctx.fillRect(zone.x, zone.y, zone.width, zone.height);

    // Joueur (bleu)
    ctx.fillStyle = '#0ff';
    ctx.shadowColor = '#0ff';
    ctx.shadowBlur = 15;
    ctx.fillRect(player.x, player.y, player.size, player.size);

    // Score
    ctx.fillStyle = '#0ff';
    ctx.font = 'bold 24px monospace';
    ctx.shadowColor = '#0ff';
    ctx.shadowBlur = 10;
    ctx.fillText(`Score: ${score}`, 20, 30);
  }

  function loop() {
    if (gameOver) return;
    movePlayer();
    updateZone();
    checkCollision();
    updateScore();
    draw();
    requestAnimationFrame(loop);
  }

  document.getElementById('restart-btn').addEventListener('click', resetGame);

  loop();
})();
</script>

</body>
</html>
